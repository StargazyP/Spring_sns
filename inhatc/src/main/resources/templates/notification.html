<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ì•Œë¦¼</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        .notification-item {
            padding: 15px;
            margin: 10px 0;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .notification-item:hover {
            background-color: #f5f5f5;
        }
        .notification-item.unread {
            background-color: #e3f2fd;
            border-left: 4px solid #2196F3;
        }
        .notification-type {
            font-weight: bold;
            color: #2196F3;
            margin-right: 10px;
        }
        .notification-content {
            margin: 5px 0;
            color: #666;
        }
        .notification-date {
            font-size: 12px;
            color: #999;
        }
        .empty-message {
            text-align: center;
            padding: 40px;
            color: #999;
        }
        .back-button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }
        .back-button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ì•Œë¦¼</h1>
            <a href="/main" class="back-button">ë©”ì¸ìœ¼ë¡œ</a>
        </div>

        <div th:if="${notifications != null && !notifications.isEmpty()}">
            <div th:each="notification : ${notifications}" 
                 class="notification-item" 
                 th:classappend="${!notification.isRead} ? 'unread' : ''"
                 th:onclick="'viewPost(' + ${notification.postId} + ')'">
                <div>
                    <span class="notification-type" th:text="${notification.notificationType == 'LIKE' ? 'â¤ï¸ ì¢‹ì•„ìš”' : 'ğŸ’¬ ëŒ“ê¸€'}"></span>
                    <span th:text="${notification.actorName != null ? notification.actorName : notification.actorEmail}"></span>ë‹˜ì´
                    <span th:text="${notification.notificationType == 'LIKE' ? 'ì¢‹ì•„ìš”ë¥¼ ëˆŒë €ìŠµë‹ˆë‹¤' : 'ëŒ“ê¸€ì„ ë‚¨ê²¼ìŠµë‹ˆë‹¤'}"></span>
                </div>
                <div class="notification-content" th:text="${notification.postContent}"></div>
                <div class="notification-date" th:text="${#temporals.format(notification.createdAt, 'yyyy-MM-dd HH:mm')}"></div>
            </div>
        </div>
        <div th:if="${notifications == null || notifications.isEmpty()}" class="empty-message">
            ìƒˆë¡œìš´ ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤.
        </div>
    </div>

    <script>
        function viewPostFromNotification(postId, notificationId) {
            // ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬
            if (notificationId) {
                fetch(`/posts/notifications/read?notificationId=${notificationId}`, {
                    method: 'POST'
                }).then(() => {
                    // ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ê³  í•´ë‹¹ ê²Œì‹œë¬¼ ëª¨ë‹¬ ì—´ê¸°
                    window.location.href = `/main?postId=${postId}`;
                });
            } else {
                // ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ê³  í•´ë‹¹ ê²Œì‹œë¬¼ ëª¨ë‹¬ ì—´ê¸°
                window.location.href = `/main?postId=${postId}`;
            }
        }
    </script>
</body>
</html>

